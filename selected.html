<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js" type="text/javascript"></script>
  </head>

  <style type="text/css">

    .container {
      margin: 10vh 20vw 10vh 10vw;
      font-family: Arial;
    }
     
    #selectors{
      width: 100%;
      background-color: red;
      margin: 0 auto;
      padding: 2% 3% 3% 12%;

    }
    .inline {
      display: inline-block;
    }

    .selectorItem{
      position: relative;
      width: 20vw;
      display: inline-block;
      padding-left: 1%;
      padding-right: 1%;
      cursor: pointer;
    }

    #selector-text{
     width: 100%;
     margin: 0 auto;
     padding: 2% 5% 3% 10%;
     text-align: center;
     background-color: black;
     color: white;
    }

    #videowrapper {
      background-color: black;
      width: 100%;
      color: white;
      text-align: right;
      padding: 2% 7.5% 0 7.5%;
    }

    .hidden {
      display: none;
    }

    iframe {
      position: relative;
      margin: 4% 30% 0 20%;
    }

  </style>


  <body>


    <div class="container">

      <h1 id="selector-text"></h1>

      <div id="selectors">
        <div class="selectorItem" >
          <h3 id="sintel-title" class="inline"></h3>
          <h6 id="sintel-duration" data-actualDuration="52000" class="inline"></h6>
          <h5 id="sintel-description"></h5>
          <img id="sintel-thumbnail">
        </div>

        <div class="selectorItem" >
          <h3 id="bbb-title" class="inline"></h3>
          <h6 id="bbb-duration" data-actualDuration="32000" class="inline"></h6>
          <h5 id="bbb-description" ></h5>
          <img id="bbb-thumbnail">
        </div>

        <div class="selectorItem" >
          <h3 id="walle-title" class="inline"></h3>
          <h6 id="walle-duration" data-actualDuration="150000" class="inline"></h6>
          <h5 id="walle-description"></h5>
          <img id="walle-thumbnail">
        </div>
      </div>

      <div id="videowrapper" class="hidden">
        <iframe id="videoplayer" width="560" height="349" autoplay frameborder="0"> </iframe>
      </div>

    </div>

  </body>


  <script type="text/javascript">

    function parseResponse (data) {
      var results = data.components[0].config;
      var selectorText = results.views[1].text
      document.getElementById('selector-text').innerHTML = selectorText;

      document.getElementById('sintel-title').innerHTML = results.views[2].title;
      document.getElementById('sintel-description').innerHTML = results.views[2].description;
      document.getElementById('sintel-thumbnail').src = results.views[2].thumbnail;
      document.getElementById('sintel-duration').innerHTML = results.views[2].duration;
      document.getElementById('sintel-title').parentNode.setAttribute("data-videoUrl", data.components[1].config.views[1].src)

      document.getElementById('bbb-title').innerHTML = results.views[3].title;
      document.getElementById('bbb-description').innerHTML = results.views[3].description;
      document.getElementById('bbb-thumbnail').src = results.views[3].thumbnail;
      document.getElementById('bbb-duration').innerHTML = results.views[3].duration;
      document.getElementById('bbb-title').parentNode.setAttribute("data-videoUrl", data.components[2].config.views[4].src)

      document.getElementById('walle-title').innerHTML = results.views[4].title;
      document.getElementById('walle-description').innerHTML = results.views[4].description;
      document.getElementById('walle-thumbnail').src = results.views[4].thumbnail;
      document.getElementById('walle-duration').innerHTML = results.views[4].duration;
      document.getElementById('walle-title').parentNode.setAttribute("data-videoUrl", data.components[3].config.views[4].src)

    };
      
    var script = document.createElement('script');
    script.src = "http://nymeria.sel.ec/videos_for?_sm_cb=parseResponse";
    document.head.appendChild(script);

    var videowrapper = document.getElementById('videowrapper');
    var video = document.getElementsByTagName('iframe')[0];
    var selectors = document.getElementById('selectors');
    var selectorText = document.getElementById('selector-text')

    var hide = function(element) {
      element.className += ' hidden'
    }
    var show = function(element) {
      element.classList.remove('hidden')
    }

    var videoEnded = function() {
      videowrapper.removeChild(video);
      show(selectors);
      show(selectorText);
    }

    //using this method to go back to selector screen because I was having cross-domain issues with the video tag, and with accessing the video in the iframe.  This works, as long as the duration is known.  The duration wasn't accurate in the data, so I hard-coded it for demonstration purposes.  
    $('.selectorItem').click(function(){
      //This would work if the duration in the data was accurate:
      // var duration = parseFloat((this.getElementsByTagName('h6')[0].innerHTML).slice(-2)) * 2000 + 2000;
      var duration = this.getElementsByTagName('h6')[0].getAttribute('data-actualDuration') + 2000;
      var url = this.getAttribute("data-videoUrl");
      videowrapper.appendChild(video)
      video.src = url;
      show(videowrapper);  
      hide(selectors);
      hide(selectorText);
      setTimeout(videoEnded, duration);
    });

</script>

</html>


